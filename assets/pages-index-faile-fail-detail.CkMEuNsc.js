var ue=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var E=(f,n,u)=>n in f?ue(f,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):f[n]=u,O=(f,n)=>{for(var u in n||(n={}))de.call(n,u)&&E(f,u,n[u]);if(A)for(var u of A(n))ce.call(n,u)&&E(f,u,n[u]);return f},D=(f,n)=>re(f,ie(n));var h=(f,n,u)=>new Promise((B,c)=>{var m=i=>{try{v(u.next(i))}catch(p){c(p)}},b=i=>{try{v(u.throw(i))}catch(p){c(p)}},v=i=>i.done?B(i.value):Promise.resolve(i.value).then(m,b);v((u=u.apply(f,n)).next())});import{d as fe,u as me,r as d,x as pe,Q as _e,a as ve,w as a,b as K,e as T,f as N,o as C,g as e,i as ye,l as s,k as r,t as V,z as we,K as $,j as z,y as g,R as k,M as G,m as y,O as be,P as M,n as U,S as ge,p as ke}from"./index-BFESJqT6.js";import{_ as xe,a as he}from"./wd-radio-group.9KkIYOXO.js";import{a as Ve,_ as Te}from"./wd-textarea.BEJUYWe4.js";import{B as Ne}from"./bottomBtn.C1nJVWm-.js";import{T as Ue}from"./TopHeader.Cms7bPsr.js";import{c as Be,d as Q,u as Ie,e as Oe,f as q,h as De}from"./jdwl.28qN5MSr.js";import"./useChildren.CLrwCYJ2.js";import"./vue-query.B9vfsHwb.js";const Ce=fe({__name:"fail-detail",setup(f){const n=me(),u=d(n.userInfo.channelName),B=d(n.userInfo.user.nickName),c=d({}),m=d("1"),b=d(""),v=d(""),i=d(""),p=d(""),x=d("");d([]);const S=d([]),P=d([]),F=d([]),L=d([]),j=d("");pe(t=>{j.value=t.type,t.type==="todo"?Be({params:{processKey:t.procInsId}}).then(o=>{o.code===200&&(c.value=o.data)}):Y(t.id),W(),J()}),_e([()=>i.value,()=>p.value],t=>h(this,null,function*(){if(t[0]){const o=yield Q({params:{channelName:t[0]}});S.value=o.rows}if(t[1]){const o=yield De({params:{teamName:t[0],esopArea:t[1],orderType:"0"}});P.value=o.rows}}));function J(){return h(this,null,function*(){const t=yield Q({params:{channelName:""}});L.value=t.rows})}function W(){return h(this,null,function*(){const t=yield Ie({params:{dictType:"jdwl_need_type"}});F.value=t.data})}function X(t){const o=F.value.find(l=>l.dictValue===t);return o?o.dictLabel:t}function Y(t){return h(this,null,function*(){const o=yield Oe({params:{id:t}});o.code===200&&(c.value=o.data)})}function Z(){if(m.value==="1"){if(!b.value.trim()){y({title:"请输入失败原因",icon:"none"});return}if(!v.value.trim()){y({title:"请输入处理备注",icon:"none"});return}ee()}else if(m.value==="2"){if(!i.value){y({title:"请选择装维团队",icon:"none"});return}if(!p.value){y({title:"请选择sop小区",icon:"none"});return}if(!x.value){y({title:"请选择装维人员",icon:"none"});return}ae()}}function ee(){be({title:"提交中..."}),q({body:D(O({},c.value),{id:c.value.id,failHandle:m.value,failResult:b.value,remark:v.value})}).then(t=>{t.code===200?(M(),y({title:"提交成功",icon:"success"}),setTimeout(()=>{U({url:"/pages-index/faile/faile"})},1500)):(M(),y({title:t.msg,icon:"none"}))})}function ae(){q({body:D(O({},c.value),{id:c.value.id,failHandle:m.value,teamName:i.value,esopArea:p.value,approveUserId:x.value})}).then(t=>{t.code===200?(y({title:"提交成功",icon:"success"}),setTimeout(()=>{j.value==="todo"?U({url:"/pages-index/todo/todo"}):U({url:"/pages-index/faile/faile"})},1500)):y({title:t.msg,icon:"none"})})}function le(){U({url:"/pages-index/faile/faile"})}function te(){ge()}return(t,o)=>{const l=ye,w=we,H=T(N("wd-radio"),xe),oe=T(N("wd-radio-group"),he),R=T(N("wd-textarea"),Ve),I=T(N("wd-picker"),Te),se=K("layout-default-uni"),ne=K("global-ku-root");return C(),ve(ne,null,{default:a(()=>[e(se,null,{default:a(()=>[e(l,{class:"fail-detail-page min-h-screen bg-[#f5f5f5]"},{default:a(()=>[e(Ue,{title:s(u),subtitle:s(B),onBack:te},null,8,["title","subtitle"]),e(l,{class:"content-container"},{default:a(()=>[e(l,{class:"info-section"},{default:a(()=>[e(l,{class:"info-title"},{default:a(()=>[r(V(X(s(c).needType)),1)]),_:1}),e(l,{class:"customer-info"},{default:a(()=>[e(l,{class:"info-row"},{default:a(()=>[e(w,{class:"info-label"},{default:a(()=>[r("客户姓名：")]),_:1}),e(w,{class:"info-value"},{default:a(()=>[r(V(s(c).customerName),1)]),_:1})]),_:1}),e(l,{class:"info-row"},{default:a(()=>[e(w,{class:"info-label"},{default:a(()=>[r("客户电话：")]),_:1}),e(w,{class:"info-value"},{default:a(()=>[r(V(s(c).customerPhone),1)]),_:1})]),_:1}),e(l,{class:"info-row"},{default:a(()=>[e(w,{class:"info-label"},{default:a(()=>[r("所在地址：")]),_:1}),e(w,{class:"info-value"},{default:a(()=>[r(V(s(c).address||"--"),1)]),_:1})]),_:1}),e(l,{class:"info-row"},{default:a(()=>[e(w,{class:"info-label"},{default:a(()=>[r("提交时间：")]),_:1}),e(w,{class:"info-value"},{default:a(()=>[r(V(s(c).createTime),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(l,{class:"process-detail-card"},{default:a(()=>[e(l,{class:"form-row",style:{"align-items":"center"}},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("处理方式： ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(oe,{modelValue:s(m),"onUpdate:modelValue":o[0]||(o[0]=_=>k(m)?m.value=_:null),inline:"",shape:"dot"},{default:a(()=>[e(H,{value:"1"},{default:a(()=>[r(" 现场处理 ")]),_:1}),e(H,{value:"2"},{default:a(()=>[r(" 装维上门 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(m)==="1"?(C(),$(G,{key:0},[e(l,{class:"form-row"},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("失败原因 ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(R,{modelValue:s(b),"onUpdate:modelValue":o[1]||(o[1]=_=>k(b)?b.value=_:null),placeholder:"请输入失败原因",rows:3,maxlength:500,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(l,{class:"form-row"},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("处理备注 ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(R,{modelValue:s(v),"onUpdate:modelValue":o[2]||(o[2]=_=>k(v)?v.value=_:null),placeholder:"请输入处理备注",rows:3,maxlength:500,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})],64)):z("",!0),s(m)==="2"?(C(),$(G,{key:1},[e(l,{class:"form-row"},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("选择装维团队 ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(I,{modelValue:s(i),"onUpdate:modelValue":o[3]||(o[3]=_=>k(i)?i.value=_:null),columns:s(L),"value-key":"resultField","label-key":"resultField",placeholder:"请选择装维团队"},null,8,["modelValue","columns"])]),_:1})]),_:1}),e(l,{class:"form-row"},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("选择sop小区 ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(I,{modelValue:s(p),"onUpdate:modelValue":o[4]||(o[4]=_=>k(p)?p.value=_:null),columns:s(S),placeholder:"请选择sop小区","label-key":"resultField","value-key":"resultField",disabled:!s(i)},null,8,["modelValue","columns","disabled"])]),_:1})]),_:1}),e(l,{class:"form-row"},{default:a(()=>[e(l,{class:"form-label"},{default:a(()=>[g("span",{style:{color:"red"}},"*"),r("选择装维人员 ")]),_:1}),e(l,{class:"form-content"},{default:a(()=>[e(I,{modelValue:s(x),"onUpdate:modelValue":o[5]||(o[5]=_=>k(x)?x.value=_:null),columns:s(P),"value-key":"userId","label-key":"nickName",placeholder:"请选择装维人员",disabled:!s(p)},null,8,["modelValue","columns","disabled"])]),_:1})]),_:1})],64)):z("",!0)]),_:1})]),_:1}),e(Ne,{"submit-text":(s(m)==="1","提交派单"),"save-draft-text":"取消",onSubmit:Z,onSaveDraft:le},null,8,["submit-text"])]),_:1})]),_:1})]),_:1})}}}),Ke=ke(Ce,[["__scopeId","data-v-fd1ae05a"]]);export{Ke as default};
