var x=(y,v,a)=>new Promise((o,u)=>{var d=l=>{try{p(a.next(l))}catch(f){u(f)}},c=l=>{try{p(a.throw(l))}catch(f){u(f)}},p=l=>l.done?o(l.value):Promise.resolve(l.value).then(d,c);p((a=a.apply(y,v)).next())});import{d as B,u as L,q as N,r as m,v as j,x as A,a as F,w as t,b as k,o as T,g as e,i as q,y as z,h as D,z as P,k as _,I as E,l as s,A as G,B as V,t as $,m as i,p as H}from"./index-PW8lkL3M.js";import{_ as J,a as K,b as M}from"./mobile.Bzo_kdCy.js";import{getSmsCodeUsingPost as O,getSmsCodeUsingCodePost as Q}from"./service-login.BuRf4w1g.js";import"./vue-query.DoLthAjK.js";const R=B({__name:"login",setup(y){L();const v=N();m("");const a=m(!1),o=j({phone:"",smsCode:""}),u=m(!1),d=m(0),c=m(!0),p=m("");A(g=>{p.value=g.type});function l(){return x(this,null,function*(){if(!o.phone.trim()){i({title:"请输入手机号",icon:"none"});return}if(!/^1[3-9]\d{9}$/.test(o.phone)){i({title:"请输入正确的手机号",icon:"none"});return}u.value=!0;try{const r=yield(p.value==="jdwl"?O:Q)({body:{phoneNum:o.phone}});if(r.code!==200){i({title:r.msg||"发送失败，请重试",icon:"none"});return}i({title:"验证码已发送",icon:"success"}),d.value=60,c.value=!1;const n=setInterval(()=>{d.value--,d.value<=0&&(clearInterval(n),c.value=!0)},1e3)}catch(g){i({title:"发送失败，请重试",icon:"none"})}finally{u.value=!1}})}function f(){return x(this,null,function*(){if(!o.phone.trim()){i({title:"请输入手机号",icon:"none"});return}if(!/^1[3-9]\d{9}$/.test(o.phone)){i({title:"请输入正确的手机号",icon:"none"});return}if(!o.smsCode.trim()){i({title:"请输入验证码",icon:"none"});return}if(o.smsCode.length!==6){i({title:"验证码为6位数字",icon:"none"});return}try{a.value=!0,sessionStorage.setItem("phone",o.phone),yield v.smsLogin(o.phone,o.smsCode,"jdwl")}catch(g){}finally{a.value=!1}})}return(g,r)=>{const n=q,h=D,C=P,w=E,S=G,I=k("layout-default-uni"),U=k("global-ku-root");return T(),F(U,null,{default:t(()=>[e(I,null,{default:t(()=>[e(n,{class:"login-container"},{default:t(()=>[e(n,{class:"status-bar"}),e(n,{class:"header"},{default:t(()=>[z("div",{class:"logo-container"},[e(h,{src:J,mode:"aspectFit",class:"logo-icon",style:{width:"200rpx",height:"100rpx"}}),e(h,{src:K,mode:"aspectFit",class:"logo-icon",style:{width:"150rpx",height:"100rpx"}})]),e(n,{class:"logo-section"},{default:t(()=>[e(h,{src:M,mode:"aspectFit",class:"logo-icon"}),e(C,{class:"logo-title"},{default:t(()=>[_("开封移动降档挽留系统")]),_:1})]),_:1})]),_:1}),e(n,{class:"login-form"},{default:t(()=>[e(n,{class:"form-container"},{default:t(()=>[e(n,{class:"input-item"},{default:t(()=>[e(n,{class:"input-label"},{default:t(()=>[_("手机号")]),_:1}),e(w,{modelValue:s(o).phone,"onUpdate:modelValue":r[0]||(r[0]=b=>s(o).phone=b),type:"number",placeholder:"请输入11位手机号",maxlength:"11",class:"native-input"},null,8,["modelValue"])]),_:1}),e(n,{class:"input-item"},{default:t(()=>[e(n,{class:"input-label"},{default:t(()=>[_("验证码")]),_:1}),e(n,{class:"sms-input-group"},{default:t(()=>[e(w,{modelValue:s(o).smsCode,"onUpdate:modelValue":r[1]||(r[1]=b=>s(o).smsCode=b),type:"number",placeholder:"请输入6位验证码",maxlength:"6",class:"native-input sms-input"},null,8,["modelValue"]),e(S,{disabled:!s(c),class:V(["native-button sms-button flex items-center justify-center",{"button-loading":s(u),"button-disabled":!s(c)}]),onClick:l},{default:t(()=>[_($(s(u)?"发送中":s(c)?"获取验证码":`${s(d)}s`),1)]),_:1},8,["disabled","class"])]),_:1})]),_:1}),e(n,{class:"login-button-wrapper"},{default:t(()=>[e(S,{class:V(["native-button login-button",{"button-loading":s(a)}]),disabled:s(a),onClick:f},{default:t(()=>[_($(s(a)?"登录中...":"立即登录"),1)]),_:1},8,["class","disabled"])]),_:1})]),_:1})]),_:1}),e(n,{class:"footer"},{default:t(()=>[e(C,{class:"footer-text"},{default:t(()=>[_("© 2025 开封业务综合平台")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),te=H(R,[["__scopeId","data-v-32939add"]]);export{te as default};
