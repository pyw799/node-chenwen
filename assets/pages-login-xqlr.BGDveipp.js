var x=(y,v,a)=>new Promise((o,u)=>{var d=l=>{try{p(a.next(l))}catch(f){u(f)}},c=l=>{try{p(a.throw(l))}catch(f){u(f)}},p=l=>l.done?o(l.value):Promise.resolve(l.value).then(d,c);p((a=a.apply(y,v)).next())});import{d as q,u as B,q as L,r as m,v as N,x as A,a as F,w as t,b as k,o as T,g as e,i as j,y as z,h as D,z as P,k as _,I as Q,l as n,A as R,B as V,t as $,m as i,p as E}from"./index-BFESJqT6.js";import{_ as G,a as H,b as J}from"./mobile.Cu0WbNcL.js";import{getSmsCodeUsingPost as K,getSmsCodeUsingCodePost as M}from"./service-login.hhOaQLQ1.js";import"./vue-query.B9vfsHwb.js";const O=q({__name:"xqlr",setup(y){B();const v=L();m("");const a=m(!1),o=N({phone:"",smsCode:""}),u=m(!1),d=m(0),c=m(!0),p=m("");A(g=>{p.value=g.type});function l(){return x(this,null,function*(){if(!o.phone.trim()){i({title:"请输入手机号",icon:"none"});return}if(!/^1[3-9]\d{9}$/.test(o.phone)){i({title:"请输入正确的手机号",icon:"none"});return}u.value=!0;try{const r=yield(p.value==="jdwl"?K:M)({body:{phoneNum:o.phone}});if(r.code!==200){i({title:r.msg||"发送失败，请重试",icon:"none"});return}i({title:"验证码已发送",icon:"success"}),d.value=60,c.value=!1;const s=setInterval(()=>{d.value--,d.value<=0&&(clearInterval(s),c.value=!0)},1e3)}catch(g){i({title:"发送失败，请重试",icon:"none"})}finally{u.value=!1}})}function f(){return x(this,null,function*(){if(!o.phone.trim()){i({title:"请输入手机号",icon:"none"});return}if(!/^1[3-9]\d{9}$/.test(o.phone)){i({title:"请输入正确的手机号",icon:"none"});return}if(!o.smsCode.trim()){i({title:"请输入验证码",icon:"none"});return}if(o.smsCode.length!==6){i({title:"验证码为6位数字",icon:"none"});return}try{a.value=!0,sessionStorage.setItem("phone",o.phone),yield v.smsLogin(o.phone,o.smsCode,"QR")}catch(g){}finally{a.value=!1}})}return(g,r)=>{const s=j,h=D,C=P,w=Q,S=R,I=k("layout-default-uni"),U=k("global-ku-root");return T(),F(U,null,{default:t(()=>[e(I,null,{default:t(()=>[e(s,{class:"login-container"},{default:t(()=>[e(s,{class:"status-bar"}),e(s,{class:"header"},{default:t(()=>[z("div",{class:"logo-container"},[e(h,{src:G,mode:"aspectFit",class:"logo-icon",style:{width:"200rpx",height:"100rpx"}}),e(h,{src:H,mode:"aspectFit",class:"logo-icon",style:{width:"150rpx",height:"100rpx"}})]),e(s,{class:"logo-section"},{default:t(()=>[e(h,{src:J,mode:"aspectFit",class:"logo-icon"}),e(C,{class:"logo-title"},{default:t(()=>[_("开封移动客户需求录入")]),_:1})]),_:1})]),_:1}),e(s,{class:"login-form"},{default:t(()=>[e(s,{class:"form-container"},{default:t(()=>[e(s,{class:"input-item"},{default:t(()=>[e(s,{class:"input-label"},{default:t(()=>[_("手机号")]),_:1}),e(w,{modelValue:n(o).phone,"onUpdate:modelValue":r[0]||(r[0]=b=>n(o).phone=b),type:"number",placeholder:"请输入11位手机号",maxlength:"11",class:"native-input"},null,8,["modelValue"])]),_:1}),e(s,{class:"input-item"},{default:t(()=>[e(s,{class:"input-label"},{default:t(()=>[_("验证码")]),_:1}),e(s,{class:"sms-input-group"},{default:t(()=>[e(w,{modelValue:n(o).smsCode,"onUpdate:modelValue":r[1]||(r[1]=b=>n(o).smsCode=b),type:"number",placeholder:"请输入6位验证码",maxlength:"6",class:"native-input sms-input"},null,8,["modelValue"]),e(S,{disabled:!n(c),class:V(["native-button sms-button flex items-center justify-center",{"button-loading":n(u),"button-disabled":!n(c)}]),onClick:l},{default:t(()=>[_($(n(u)?"发送中":n(c)?"获取验证码":`${n(d)}s`),1)]),_:1},8,["disabled","class"])]),_:1})]),_:1}),e(s,{class:"login-button-wrapper"},{default:t(()=>[e(S,{class:V(["native-button login-button",{"button-loading":n(a)}]),disabled:n(a),onClick:f},{default:t(()=>[_($(n(a)?"登录中...":"立即登录"),1)]),_:1},8,["class","disabled"])]),_:1})]),_:1})]),_:1}),e(s,{class:"footer"},{default:t(()=>[e(C,{class:"footer-text"},{default:t(()=>[_("© 2025 开封业务综合平台")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),te=E(O,[["__scopeId","data-v-e97fab7c"]]);export{te as default};
